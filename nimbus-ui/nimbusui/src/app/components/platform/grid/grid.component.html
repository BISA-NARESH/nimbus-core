
<div id="gsFlexGrid" class="scrollGrid">
	<div class="ui-datatable-header ui-widget-header" *ngIf="element.config?.uiStyles?.attributes?.showHeader == true">
		<p-header>
			{{label}}
			<nm-tooltip *ngIf="helpText" [helpText]='helpText'></nm-tooltip>
		</p-header>
		<div class="recordsDisplayed">Showing {{rowStart}}-{{rowEnd}} of  {{totalRecords}}</div>
	</div>
	
	<p-dataTable #flex #dataTable #table [value]="value"
		[(selection)]="selectedRows" 
		(onRowClick)="onRowClick($event)"
		(onRowSelect)="onRowSelect($event)"
		(onRowUnselect)="onRowUnselect($event)"
		(valueChange)="handleRowChange($event)"
		[rows]="element.config?.uiStyles?.attributes?.pageSize"
		[paginator]="element.config?.uiStyles?.attributes?.pagination"
		scrollable="true" 
        scrollHeight="200px"
		paginatorPosition="both"
		alwaysShowPaginator ="false"
		[expandableRows]="element.config?.uiStyles?.attributes?.expandableRows"
		(onRowExpand)="getAddtionalData($event)"
		(onPage)="paginate($event)"
        (onFilter)="filterCallBack($event)"
        (onSort)="updatePageDetailsState()"

		[responsive]="true" #dt> 

		<p-column styleClass="col-select" 
			selectionMode="multiple" *ngIf="element.config?.uiStyles?.attributes?.rowSelection">
		</p-column> 

		<p-column expander="true" styleClass="col-icon" *ngIf="element.config?.uiStyles?.attributes?.expandableRows"></p-column>

		<ng-template ngFor let-col [ngForOf]="params">

			<p-column *ngIf="col?.uiStyles?.attributes?.alias != 'Link' && col?.uiStyles?.attributes?.alias != 'LinkMenu' && col?.type?.nested == false"
				[field]="col?.code" 
				[header]="col?.label"
				[hidden]="col?.uiStyles?.attributes?.hidden"
				[sortable]="!col?.uiStyles?.isLink ? 'custom' : false"
				(sortFunction)="sortBy($event, col?.type?.name, col?.uiStyles?.attributes?.sortAs)"
				[filter]="col?.uiStyles?.attributes?.filter"
				[filterMatchMode]="col?.uiStyles?.attributes?.filterMode" > 
							
				<ng-template pTemplate="header"> 
					<span title="{{col?.label}}"  *ngIf="!col?.uiStyles?.isLink">{{col.label}}</span> 
					<a href="javascript:void(0)" (click)="toggleFilter($event)" class='gridFilterIcon' *ngIf="!col?.uiStyles?.isLink"></a> 
				</ng-template> 
				
				<ng-template *ngIf="col?.uiStyles?.attributes?.alias == 'CheckBox'" pTemplate="body" let-cell="rowData"> 
					<label> <input type="checkbox" (click)="postOnChange(col, cell)"> </label> 
				</ng-template>

				<ng-template let-datacol let-row="rowData" pTemplate="body">
					<ng-template ngFor let-param [ngForOf]="row.params">
						<ng-template [ngIf]="isDate(col?.type?.name)">
							<span *ngIf="datacol.field == param.config.code">{{param.leafState | dateTimeFormat: col.uiStyles?.attributes?.datePattern}}</span> 
						</ng-template>
						<ng-template [ngIf]="!isDate(col?.type?.name)">
							<span *ngIf="datacol.field == param.config.code">{{param.leafState}}</span> 
						</ng-template>
					</ng-template>
				</ng-template>

				<ng-template let-filtercol pTemplate="filter">
					<ng-template [ngIf]="isDate(col?.type?.name)">
					<input type="text" (input)="dateFilter($event, dt, filtercol.field, col?.uiStyles?.attributes?.filterMode, col?.uiStyles?.attributes?.datePattern, col?.type?.name)"> 
					</ng-template>

					<ng-template [ngIf]="!isDate(col?.type?.name)">
					<input type="text" (input)="inputFilter($event, dt, filtercol.field, col?.uiStyles?.attributes?.filterMode)">
					</ng-template>
				</ng-template> 
				
			</p-column>

			<p-column *ngIf="col?.uiStyles?.attributes?.alias=='LinkMenu'" styleClass="dropdown">
				<ng-template pTemplate="body" let-cell="rowData">
					<nm-action-dropdown [params]="col?.type?.model?.paramConfigs" [rowData]="cell" [elementPath]="getRowPath(col, cell)"></nm-action-dropdown>
				</ng-template>
			</p-column>
		</ng-template>

		<ng-template let-row pTemplate="rowexpansion">
			<nm-section [element]="row.nestedElement"></nm-section>	
		</ng-template> 
		
		<p-footer>
			<ng-template [ngIf]="element.config?.uiStyles?.attributes?.postButton">
				<div class="text-sm-left">
					<button (click)="postGridData(this)" type="button" class="btn btn-action post-btn">
						{{element.config.uiStyles.attributes.postButtonLabel}}
					</button>
				</div>
			</ng-template> 
		</p-footer> 
				   
	</p-dataTable>
</div>
